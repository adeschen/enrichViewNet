<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="pandoc">
<meta http-equiv="X-UA-Compatible" content="IE=EDGE">
<meta name="author" content="Astrid Deschênes and Pascal Belleau">
<meta name="date" content="2023-09-13">
<title>From functional enrichment results to biological networks</title>
<script src="gprofiler2cytoscape_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="gprofiler2cytoscape_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="gprofiler2cytoscape_files/bootstrap-3.3.5/js/bootstrap.min.js"></script><script src="gprofiler2cytoscape_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script><script src="gprofiler2cytoscape_files/bootstrap-3.3.5/shim/respond.min.js"></script><style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       </style>
<script src="gprofiler2cytoscape_files/navigation-1.1/tabsets.js"></script><style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>
<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script><style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>
<link rel="stylesheet" href="/__w/_temp/Library/BiocStyle/resources/html/bioconductor.css" type="text/css">
<style type="text/css">
.main-container {
  max-width: 828px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
</style>
<!-- tabsets --><style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>
<!-- code folding --><script>
function toggle_visibility(id1) {
  var e = document.getElementById(id1);
  e.style.display = ((e.style.display!="none") ? "none" : "block");
}
</script>
</head>
<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">From functional enrichment results to biological networks</h1>
<p class="author-name">Astrid Deschênes and Pascal Belleau</p>
<h4 class="date">13 September 2023</h4>

</div>

<h1>Contents</h1>
<div id="TOC">
<ul>
<li><a href="#licensing" id="toc-licensing"><span class="toc-section-number">1</span> Licensing</a></li>
<li><a href="#citing" id="toc-citing"><span class="toc-section-number">2</span> Citing</a></li>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">3</span> Introduction</a></li>
<li><a href="#installation" id="toc-installation"><span class="toc-section-number">4</span> Installation</a></li>
<li><a href="#general-workflow" id="toc-general-workflow"><span class="toc-section-number">5</span> General workflow</a></li>
<li>
<a href="#transforming-enrichment-results-into-a-cytoscape-gene-term-network" id="toc-transforming-enrichment-results-into-a-cytoscape-gene-term-network"><span class="toc-section-number">6</span> Transforming enrichment results into a Cytoscape gene-term network</a>
<ul>
<li><a href="#run-an-enrichment-analysis" id="toc-run-an-enrichment-analysis"><span class="toc-section-number">6.1</span> Run an enrichment analysis</a></li>
<li><a href="#start-cytoscape" id="toc-start-cytoscape"><span class="toc-section-number">6.2</span> Start Cytoscape</a></li>
<li><a href="#create-a-cytoscape-network" id="toc-create-a-cytoscape-network"><span class="toc-section-number">6.3</span> Create a Cytoscape network</a></li>
</ul>
</li>
<li><a href="#transforming-gprofiler2-enrichment-results-into-a-enrichment-map" id="toc-transforming-gprofiler2-enrichment-results-into-a-enrichment-map"><span class="toc-section-number">7</span> Transforming gprofiler2 enrichment results into a enrichment map</a></li>
<li><a href="#acknowledgments" id="toc-acknowledgments"><span class="toc-section-number">8</span> Acknowledgments</a></li>
<li><a href="#session-info" id="toc-session-info"><span class="toc-section-number">9</span> Session info</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p><br><strong>Package</strong>: <em>gprofiler2cytoscape</em><br><strong>Authors</strong>: Astrid Deschênes [aut, cre] (<a href="https://orcid.org/0000-0001-7846-6749" class="external-link uri">https://orcid.org/0000-0001-7846-6749</a>),
Pascal Belleau [aut] (<a href="https://orcid.org/0000-0002-0802-1071" class="external-link uri">https://orcid.org/0000-0002-0802-1071</a>)<br><strong>Version</strong>: 0.0.4<br><strong>Compiled date</strong>: 2023-09-13<br><strong>License</strong>: Artistic-2.0<br></p>
<div class="section level2" number="1">
<h2 id="licensing">
<span class="header-section-number">1</span> Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a>
</h2>
<p>The <em><a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link">gprofiler2cytoscape</a></em> package and the underlying
<em><a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link">gprofiler2cytoscape</a></em> code are distributed under the
Artistic license 2.0. You are free to use and redistribute this software.</p>
<p><br><br></p>
</div>
<div class="section level2" number="2">
<h2 id="citing">
<span class="header-section-number">2</span> Citing<a class="anchor" aria-label="anchor" href="#citing"></a>
</h2>
<p>If you use this package for a publication, we would ask you to cite the
following:</p>
<blockquote>
<p>Astrid Deschênes and Pascal Belleau (2021). gprofiler2cytoscape: From
functional enrichment results to biological networks.
<a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link uri">https://github.com/adeschen/gprofiler2cytoscape</a>,
<a href="https://adeschen.github.io/gprofiler2cytoscape/" class="external-link uri">https://adeschen.github.io/gprofiler2cytoscape/</a>.</p>
</blockquote>
<p><br><br></p>
</div>
<div class="section level2" number="3">
<h2 id="introduction">
<span class="header-section-number">3</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>High-throughput technologies are routinely used in basic and applied
research and are key drivers of scientific discovery. A major challenge
in using these experimental approaches is the analysis of the large amount
of data generated. These include lists of proteins or genes generated by
mass spectrometry, single-cell RNA sequencing and/or microarray analysis,
respectively. There is thus a need for robust bioinformatic and statistical
tools that can analyze these large datasets and display the data in the form
of networks that illustrate the biological and conceptual links with findings
in the literature. This gap has been partially addressed by several
bioinformatic tools that perform enrichment analysis of the data and/or
present it in the form of networks.</p>
<p>Functional enrichment analysis tools, such as <em>Enrichr</em> <span class="citation">(<a href="#ref-Kuleshov2016">Kuleshov et al. 2016</a>)</span> and
<em>DAVID</em> <span class="citation">(<a href="#ref-Dennis2003">Dennis et al. 2003</a>)</span>, are specialized in positioning novel findings against
well curated data sources of biological processes and pathways.
Most specifically, those tools identify functionally coherent gene sets that
are statistically over- (or under-) represented in a gene list.
The traditional output of an enrichment analysis tool is a table containing
the significant gene sets with their associated statistics. While those
results are extremely useful, their interpretation is challenging. The visual
representation of these results as a network can greatly facilitate the
interpretation of the data.</p>
<p>Biological network models are visual representations of various biological
interacting elements which are based on mathematical graphs. In those
networks, the biological elements are generally represented by nodes while
the interactions and relationships are represented by edges. One of the
widely used network tools in the quantitative biology community is the
open source software <em>Cytoscape</em> <span class="citation">(<a href="#ref-PaulShannon2003">Shannon et al. 2003</a>)</span>. In addition of
biological data visualization and network
analysis, <em>Cytoscape</em> can be expended through the use of
specialized plug-ins such as <em>BiNGO</em> that calculates over-represented GO terms
in a network <span class="citation">(<a href="#ref-Maere2005">Maere, Heymans, and Kuiper 2005</a>)</span> or <em>CentiScaPe</em> that identifies relevant network
nodes <span class="citation">(<a href="#ref-Scardoni2009">Scardoni, Petterlini, and Laudanna 2009</a>)</span>.</p>
<p>The <em>g:Profiler</em> enrichment analysis tool <span class="citation">(<a href="#ref-Raudvere2019">Raudvere et al. 2019</a>)</span> is web based and has
the particularity of being accompanied by the CRAN package
<em>gprofiler2</em> <span class="citation">(<a href="#ref-Kolberg2020">Kolberg et al. 2020</a>)</span>. The <em>gprofiler2</em> package gives the opportunity to
researchers to incorporate functional enrichment analysis into automated
analysis pipelines written in R. This greatly facilitates research
reproducibility.</p>
<p>The <strong><em>gprofiler2cytoscape</em></strong> package offers multiple types of visualization
of functional enrichment results. Visualization of enriched terms aims to
reduce the complexity of the analyses of complex results. Moreover, the
<strong><em>gprofiler2cytoscape</em></strong> package takes advantage of a powerful network
visualization tool which is <em>Cytoscape</em>. By doing so, all the<br>
functionalities of this mature software can be used by users to personalize
and analyze the enrichment networks.</p>
<p>First, the <strong><em>gprofiler2cytoscape</em></strong> package enables the
visualization of enrichment results generated by <em>gprofiler2</em> as a
customizable <em>Cytoscape</em> network <span class="citation">(<a href="#ref-PaulShannon2003">Shannon et al. 2003</a>)</span>. In the biological
networks generated by <strong><em>gprofiler2cytoscape</em></strong>, both
gene datasets (GO terms/pathways/protein complexes) and genes associated
to the datasets are represented as nodes. While the edges connect each gene
to its dataset(s). Only genes present in the query used for the
enrichment analysis are shown.</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:graphDemo01"></span>
<img src="demo01.jpeg" alt="A network where significant GO terms and genes are presented as nodes while edges connect each gene to its associated term(s)." width="90%"><p class="caption">
Figure 1: <span class="caption-title">A network where significant GO terms and genes are presented as nodes while edges connect each gene to its associated term(s)</span><br></p>
</div>
<p>The <strong><em>gprofiler2cytoscape</em></strong> package
offers the option to generate a network for only a portion of the
significant terms by selecting the source or by providing a
specific list of terms.</p>
<p>Once the network is created, the user can personalize the visual attributes
and integrate external information such as expression profiles, phenotypes
and other molecular states. The user can also perform network analysis.</p>
<p>In addition, the <strong><em>gprofiler2cytoscape</em></strong> package also provides the option to<br>
create enrichment maps from functional enrichment results.
The enrichment maps have been introduced in the Bioconductor
<strong><em>enrichplot</em></strong> package <span class="citation">(<a href="#ref-Yu2022">Yu 2022</a>)</span>.
Enrichment maps enable the visualization of enriched terms into a network
with edges connecting overlapping genes. Thus, enriched terms with overlapping
genes cluster together. This type of graphs facilitate the
identification of functional modules.</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:graphDemo02"></span>
<img src="demo_KEGG_emap_v01.jpeg" alt="An enrichment map using Kegg terms." width="90%"><p class="caption">
Figure 2: <span class="caption-title">An enrichment map using Kegg terms</span><br></p>
</div>
<p><br><br></p>
</div>
<div class="section level2" number="4">
<h2 id="installation">
<span class="header-section-number">4</span> Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the latest version accessible on the
<em><a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link">gprofiler2cytoscape</a></em> Github Website, the
<em><a href="https://CRAN.R-project.org/package=devtools" class="external-link">devtools</a></em> package is required.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install the latest version of gprofiler2cytoscape</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'adeschen/gprofiler2cytoscape'</span><span class="op">)</span></span></code></pre></div>
<p>It is also possible to install an official release. The list of available
releases is posted on the <a href="https://github.com/adeschen/gprofiler2cytoscape/releases" title="gprofiler2cytoscape Release Site" class="external-link">gprofiler2cytoscape Release Website</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install the version v0.1 of gprofiler2cytoscape</span></span>
<span><span class="co">## using 'ref' parameter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'adeschen/gprofiler2cytoscape'</span>, ref <span class="op">=</span> <span class="st">"v0.0.4"</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
</div>
<div class="section level2" number="5">
<h2 id="general-workflow">
<span class="header-section-number">5</span> General workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h2>
<p>The following workflow gives an overview of the capabilities of
<em><a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link">gprofiler2cytoscape</a></em>:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graphWorkflow"></span>
<img src="Figure_gprofiler2cytoscape_workflow_v01.png" alt="The gprofiler2cytoscape workflow" width="100%"><p class="caption">
Figure 3: <span class="caption-title">The gprofiler2cytoscape workflow</span><br></p>
</div>
<p>The principal input of <strong><em>gprofiler2cytoscape</em></strong> is a functional enrichment
result in a format identical to the one generated by the CRAN
<em>gprofiler2</em> package.</p>
<p>From an enrichment result, the <strong><em>gprofiler2cytoscape</em></strong> offers two options:</p>
<ul>
<li>generate a gene-term network that can be loaded in <em>Cytoscape</em> software</li>
<li>generate a enrichment map</li>
</ul>
<p>For the gene-term network, the installation of <em>Cytoscape</em> software is
highly recommended.</p>
<p><br><br></p>
</div>
<div class="section level2" number="6">
<h2 id="transforming-enrichment-results-into-a-cytoscape-gene-term-network">
<span class="header-section-number">6</span> Transforming enrichment results into a Cytoscape gene-term network<a class="anchor" aria-label="anchor" href="#transforming-enrichment-results-into-a-cytoscape-gene-term-network"></a>
</h2>
<p>The following workflow gives an overview of the steps associated to the
creation of an gene-term network loadable in <em>Cytoscape</em>.</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:graphListToGraph01"></span>
<img src="FromListToGraph_v01.jpg" alt="From an enrichment list to a Cytoscape network" width="100%"><p class="caption">
Figure 4: <span class="caption-title">From an enrichment list to a Cytoscape network</span><br></p>
</div>
<p>The key steps for the workflow are:</p>
<div class="horizontal-scroll"><table class="table">
<colgroup>
<col width="42%">
<col width="57%">
</colgroup>
<thead><tr class="header">
<th>Step</th>
<th>Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Run an enrichment analysis</td>
<td><code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code></td>
</tr>
<tr class="even">
<td>Start <em>Cytoscape</em>
</td>
<td>outside R</td>
</tr>
<tr class="odd">
<td>Create a Cytoscape network</td>
<td><code><a href="../reference/createNetwork.html">createNetwork()</a></code></td>
</tr>
</tbody>
</table></div>
<p>The <code>package::function()</code> notation is used for functions from other packages.</p>
<div class="section level3" number="6.1">
<h3 id="run-an-enrichment-analysis">
<span class="header-section-number">6.1</span> Run an enrichment analysis<a class="anchor" aria-label="anchor" href="#run-an-enrichment-analysis"></a>
</h3>
<p>The first step consists in running an enrichment analysis with
<em><a href="https://CRAN.R-project.org/package=gprofiler2" class="external-link">gprofiler2</a></em> package. The output of the <em>gprofiler2::gost()</em>
is a <em>list</em> and should be saved.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Required library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gprofiler2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The dataset of differentially expressed genes done between </span></span>
<span><span class="co">## napabucasin treated and DMSO control parental (Froeling et al 2019)</span></span>
<span><span class="co">## All genes testd are present</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"parentalNapaVsDMSODEG"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Retain significant results </span></span>
<span><span class="co">## (absolute fold change superior to 1 and adjusted p-value inferior to 0.05)</span></span>
<span><span class="va">retained</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">parentalNapaVsDMSODEG</span><span class="op">$</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">parentalNapaVsDMSODEG</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">signRes</span> <span class="op">&lt;-</span>  <span class="va">parentalNapaVsDMSODEG</span><span class="op">[</span><span class="va">retained</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">## Run one functional enrichment analysis using all significant genes</span></span>
<span><span class="co">## The species is homo sapiens ("hsapiens")</span></span>
<span><span class="co">## The g:SCS multiple testing correction method (Raudvere U et al 2019)</span></span>
<span><span class="co">## The WikiPathways database is used</span></span>
<span><span class="co">## Only the significant results are retained (significant=TRUE)</span></span>
<span><span class="co">## The evidence codes are included in the results (evcodes=TRUE)</span></span>
<span><span class="co">## A custom background included the tested genes is used</span></span>
<span><span class="va">gostres</span> <span class="op">&lt;-</span> <span class="fu">gprofiler2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gost</a></span><span class="op">(</span></span>
<span>                query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parental_napa_vs_DMSO<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">signRes</span><span class="op">$</span><span class="va">EnsemblID</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                organism<span class="op">=</span><span class="st">"hsapiens"</span>,</span>
<span>                correction_method<span class="op">=</span><span class="st">"g_SCS"</span>,</span>
<span>                sources<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WP"</span><span class="op">)</span>,</span>
<span>                significant<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                evcodes<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                custom_bg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">parentalNapaVsDMSODEG</span><span class="op">$</span><span class="va">EnsemblID</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The gost() function returns an named list of 2 entries:
* The <strong>result</strong> entry contains the enrichment results.
* The <strong>meta</strong> entry contains the metadata information.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The 'gostres' object is a list of 2 entries</span></span>
<span><span class="co">## The 'result' entry contains the enrichment results</span></span>
<span><span class="co">## The 'meta' entry contains the metadata information</span></span>
<span></span>
<span><span class="co">## Some columns of interest in the results</span></span>
<span><span class="va">gostres</span><span class="op">$</span><span class="va">result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"query"</span>, <span class="st">"p_value"</span>, <span class="st">"term_size"</span>, </span>
<span>                    <span class="st">"query_size"</span>, <span class="st">"intersection_size"</span>, <span class="st">"term_id"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## The term names can be longer than the one shown</span></span>
<span><span class="va">gostres</span><span class="op">$</span><span class="va">result</span><span class="op">[</span><span class="fl">19</span><span class="op">:</span><span class="fl">22</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"term_id"</span>, <span class="st">"source"</span>, <span class="st">"term_name"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3" number="6.2">
<h3 id="start-cytoscape">
<span class="header-section-number">6.2</span> Start Cytoscape<a class="anchor" aria-label="anchor" href="#start-cytoscape"></a>
</h3>
<p><a href="https://cytoscape.org/" class="external-link">Cytoscape</a> is an open source software for
visualizing networks. It enables network integration with any type of attribute
data. The Cytoscape software
is available at the <a href="https://cytoscape.org/" class="external-link">Cytoscape website</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cytoscapeLogo01"></span>
<img src="cy3sticker.png" alt="Cytoscape software logo." width="100%"><p class="caption">
Figure 5: <span class="caption-title">Cytoscape software logo</span><br></p>
</div>
<p>The Cytoscape network generated by
<em><a href="https://github.com/adeschen/gprofiler2cytoscape" class="external-link">gprofiler2cytoscape</a></em>
will be automatically loaded into the <a href="https://cytoscape.org/" class="external-link">Cytoscape</a>
software when the application is running.</p>
<p>If the application is not running, a CX JSON file will be created. The file
can then be loaded manually into the <a href="https://cytoscape.org/" class="external-link">Cytoscape</a>
software.</p>
</div>
<div class="section level3" number="6.3">
<h3 id="create-a-cytoscape-network">
<span class="header-section-number">6.3</span> Create a Cytoscape network<a class="anchor" aria-label="anchor" href="#create-a-cytoscape-network"></a>
</h3>
<p>TODO</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load demo gprofiler2 enrichment result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"parentalNapaVsDMSOEnrichment"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create network for REACTOME significant terms</span></span>
<span><span class="co">## The 'removeRoot=TRUE' parameter removes the root term from the network</span></span>
<span><span class="fu"><a href="../reference/createNetwork.html">createNetwork</a></span><span class="op">(</span>gostObject<span class="op">=</span><span class="va">parentalNapaVsDMSOEnrichment</span>, source<span class="op">=</span><span class="st">"REAC"</span>, </span>
<span>                removeRoot<span class="op">=</span><span class="cn">FALSE</span>, title<span class="op">=</span><span class="st">"Reactome_All"</span>, </span>
<span>                collection<span class="op">=</span><span class="st">"parental_napa_vs_DMSO"</span><span class="op">)</span></span></code></pre></div>
<br><br><div class="figure" style="text-align: center">
<span style="display:block;" id="fig:networkInCytoscape"></span>
<img src="cytoscape_reactome_all_parental_napa_vs_DMSO.png" alt="All reactome terms in a gene-term network loaded in Cytoscape." width="100%"><p class="caption">
Figure 6: <span class="caption-title">All reactome terms in a gene-term network loaded in Cytoscape</span><br></p>
</div>
</div>
</div>
<div class="section level2" number="7">
<h2 id="transforming-gprofiler2-enrichment-results-into-a-enrichment-map">
<span class="header-section-number">7</span> Transforming gprofiler2 enrichment results into a enrichment map<a class="anchor" aria-label="anchor" href="#transforming-gprofiler2-enrichment-results-into-a-enrichment-map"></a>
</h2>
<p>TODO</p>
<p><br><br></p>
</div>
<div class="section level2" number="8">
<h2 id="acknowledgments">
<span class="header-section-number">8</span> Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>The differentially expressed genes between napabucasin-treated cells (0.5 uM)
and DMSO as vehicle control are reprinted from
Clinical Cancer Research, 2019, 25 (23), 7162–7174,
Fieke E.M. Froeling, Manojit Mosur Swamynathan, Astrid Deschênes,
Iok In Christine Chio, Erin Brosnan, Melissa A. Yao, Priya Alagesan,
Matthew Lucito, Juying Li, An-Yun Chang, Lloyd C. Trotman, Pascal Belleau,
Youngkyu Park, Harry A. Rogoff, James D. Watson, David A. Tuveson,
Bioactivation of napabucasin triggers reactive oxygen species–mediated
cancer cell death, with permission from AACR.</p>
<p><br><br></p>
</div>
<div class="section level2" number="9">
<h2 id="session-info">
<span class="header-section-number">9</span> Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>Here is the output of sessionInfo() on the system on which this document
was compiled:</p>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] gprofiler2_0.2.2          gprofiler2cytoscape_0.0.4</span></span>
<span><span class="co">## [3] knitr_1.44                BiocStyle_2.29.1         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.4        xfun_0.40           bslib_0.5.1        </span></span>
<span><span class="co">##  [4] ggplot2_3.4.3       htmlwidgets_1.6.2   caTools_1.18.2     </span></span>
<span><span class="co">##  [7] vctrs_0.6.3         tools_4.3.1         bitops_1.0-7       </span></span>
<span><span class="co">## [10] generics_0.1.3      stats4_4.3.1        base64url_1.4      </span></span>
<span><span class="co">## [13] tibble_3.2.1        fansi_1.0.4         pkgconfig_2.0.3    </span></span>
<span><span class="co">## [16] KernSmooth_2.23-22  data.table_1.14.8   RColorBrewer_1.1-3 </span></span>
<span><span class="co">## [19] RCy3_2.21.2         uuid_1.1-1          graph_1.79.1       </span></span>
<span><span class="co">## [22] lifecycle_1.0.3     compiler_4.3.1      stringr_1.5.0      </span></span>
<span><span class="co">## [25] gplots_3.1.3        munsell_0.5.0       repr_1.1.6         </span></span>
<span><span class="co">## [28] uchardet_1.1.1      htmltools_0.5.6     sass_0.4.7         </span></span>
<span><span class="co">## [31] RCurl_1.98-1.12     yaml_2.3.7          lazyeval_0.2.2     </span></span>
<span><span class="co">## [34] plotly_4.10.2       tidyr_1.3.0         pillar_1.9.0       </span></span>
<span><span class="co">## [37] crayon_1.5.2        jquerylib_0.1.4     cachem_1.0.8       </span></span>
<span><span class="co">## [40] gtools_3.9.4        tidyselect_1.2.0    digest_0.6.33      </span></span>
<span><span class="co">## [43] stringi_1.7.12      purrr_1.0.2         dplyr_1.1.3        </span></span>
<span><span class="co">## [46] bookdown_0.35       RJSONIO_1.3-1.8     fastmap_1.1.1      </span></span>
<span><span class="co">## [49] grid_4.3.1          colorspace_2.1-0    cli_3.6.1          </span></span>
<span><span class="co">## [52] magrittr_2.0.3      base64enc_0.1-3     XML_3.99-0.14      </span></span>
<span><span class="co">## [55] utf8_1.2.3          IRdisplay_1.1       scales_1.2.1       </span></span>
<span><span class="co">## [58] backports_1.4.1     IRkernel_1.3.2      rmarkdown_2.24     </span></span>
<span><span class="co">## [61] httr_1.4.7          pbdZMQ_0.3-10       evaluate_0.21      </span></span>
<span><span class="co">## [64] viridisLite_0.4.2   rlang_1.1.1         glue_1.6.2         </span></span>
<span><span class="co">## [67] BiocManager_1.30.22 BiocGenerics_0.47.0 strex_1.6.0        </span></span>
<span><span class="co">## [70] jsonlite_1.8.7      R6_2.5.1            fs_1.6.3</span></span></code></pre>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Dennis2003" class="csl-entry">
Dennis, Glynn, Brad T. Sherman, Douglas A. Hosack, Jun Yang, Wei Gao, H. Clifford Lane, and Richard A. Lempicki. 2003. <span>“<span class="nocase">DAVID: Database for Annotation, Visualization, and Integrated Discovery.</span>”</span> <em>Genome Biology</em> 4 (5). <a href="https://doi.org/10.1186/gb-2003-4-9-r60" class="external-link">https://doi.org/10.1186/gb-2003-4-9-r60</a>.
</div>
<div id="ref-Kolberg2020" class="csl-entry">
Kolberg, Liis, Uku Raudvere, Ivan Kuzmin, Jaak Vilo, and Hedi Peterson. 2020. <span>“<span class="nocase">gprofiler2 – an R package for gene list functional enrichment analysis and namespace conversion toolset g:Profiler</span>.”</span> <em>F1000Research</em> 9: 1–27. <a href="https://doi.org/10.12688/f1000research.24956.1" class="external-link">https://doi.org/10.12688/f1000research.24956.1</a>.
</div>
<div id="ref-Kuleshov2016" class="csl-entry">
Kuleshov, Maxim V., Matthew R. Jones, Andrew D. Rouillard, Nicolas F. Fernandez, Qiaonan Duan, Zichen Wang, Simon Koplev, et al. 2016. <span>“<span class="nocase">Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</span>.”</span> <em>Nucleic Acids Research</em> 44 (W1): W90–97. <a href="https://doi.org/10.1093/nar/gkw377" class="external-link">https://doi.org/10.1093/nar/gkw377</a>.
</div>
<div id="ref-Maere2005" class="csl-entry">
Maere, Steven, Karel Heymans, and Martin Kuiper. 2005. <span>“<span class="nocase">BiNGO: a Cytoscape plugin to assess overrepresentation of Gene Ontology categories in Biological Networks</span>.”</span> <em>Bioinformatics</em> 21 (16): 3448–49. <a href="https://doi.org/10.1093/bioinformatics/bti551" class="external-link">https://doi.org/10.1093/bioinformatics/bti551</a>.
</div>
<div id="ref-Raudvere2019" class="csl-entry">
Raudvere, Uku, Liis Kolberg, Ivan Kuzmin, Tambet Arak, Priit Adler, Hedi Peterson, and Jaak Vilo. 2019. <span>“<span class="nocase">G:Profiler: A web server for functional enrichment analysis and conversions of gene lists (2019 update)</span>.”</span> <em>Nucleic Acids Research</em> 47 (W1): W191–98. <a href="https://doi.org/10.1093/nar/gkz369" class="external-link">https://doi.org/10.1093/nar/gkz369</a>.
</div>
<div id="ref-Scardoni2009" class="csl-entry">
Scardoni, Giovanni, Michele Petterlini, and Carlo Laudanna. 2009. <span>“<span class="nocase">Analyzing biological network parameters with CentiScaPe</span>.”</span> <em>Bioinformatics</em> 25 (21): 2857–59. <a href="https://doi.org/10.1093/bioinformatics/btp517" class="external-link">https://doi.org/10.1093/bioinformatics/btp517</a>.
</div>
<div id="ref-PaulShannon2003" class="csl-entry">
Shannon, Paul, Andrew Markiel, Owen Ozier, Nitin S Baliga, Jonathan T Wang, Daniel Ramage, Nada Amin, Benno Schwikowski, and Trey Ideker. 2003. <span>“<span class="nocase">Cytoscape: a software environment for integrated models of biomolecular interaction networks.</span>”</span> <em>Genome Research</em> 13 (11): 2498–2504. <a href="https://doi.org/10.1101/gr.1239303" class="external-link">https://doi.org/10.1101/gr.1239303</a>.
</div>
<div id="ref-Yu2022" class="csl-entry">
Yu, Guangchuang. 2022. <em>Enrichplot: Visualization of Functional Enrichment Result</em>. <a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">https://yulab-smu.top/biomedical-knowledge-mining-book/</a>.
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script><!-- tabsets --><script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script><!-- code folding --><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      styles: {
        ".MathJax_Display": {
           "text-align": "center",
           padding: "0px 150px 0px 65px",
           margin: "0px 0px 0.5em"
        },
        "@media screen and (max-width: 991px)": {
            ".MathJax_Display": {
               "text-align": "center",
               padding: "0 0 0 0"
            }
         }
      }
    }
  });
</script><script type="text/javascript">
$(document).ready(function ()  {
  
  // Map "enter" keypress to the same action as a cursor click
  function navigateLink(e) {
    if (e.key === "Enter") {
      $(this).trigger("click");
    }
  }

  var toc_items = document.querySelectorAll(".tocify-item");
  for (var i = 0; i < toc_items.length; i++) {
    // The link role tells screen readers this is for navigation
    toc_items.item(i).setAttribute("role", "link");
    // tabindex = 0 allows selection via keyboard tab presses
    toc_items.item(i).setAttribute("tabindex", "0");
    // Listen for "Enter" keypress when item is selected
    toc_items.item(i).addEventListener("keydown", navigateLink);
  }
});
</script>
</body>
</html>
